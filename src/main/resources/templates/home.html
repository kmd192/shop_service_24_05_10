<html layout:decorate="~{layout}"
      xmlns:layout="http://ultraq.net.nz/thymeleaf/layout"
      xmlns:th="http://thymeleaf.org">

<div layout:fragment="content" class="container min-vh-100 my-3">
    <div class="row my-3">
        <div class="col-3">
            <form class="input-group">
                <select class="form-select" th:name="sortList" th:value="${sortList}">
                    <option th:selected="${sortList == 'NEW'}" th:value="NEW" th:text="최신순" selected></option>
                    <option th:selected="${sortList == 'OLD'}" th:value="OLD">등록순</option>
                    <option th:selected="${sortList == 'CHEAP'}" th:value="CHEAP">낮은가격순</option>
                    <option th:selected="${sortList == 'EXPENSIVE'}" th:value="EXPENSIVE">높은가격순</option>
                    <option th:selected="${sortList == 'LIKE'}" th:value="LIKE">인기순</option>
                </select>
            </form>
        </div>
        <div class="col-1"></div>
        <div class="col-8">
            <form class="input-group">
                <input type="text" onclick="onClick()" id="kw" class="form-control" th:value="${kw}" placeholder="검색어를 입력해주세요.">
                <button onclick="onClick2()" class="btn btn-outline-secondary" type="submit" style="margin-top:0;">검색</button>
            </form>
        </div>
    </div>
    <div class="row my-3">
        <div class="col-1">
            <form class="input-group">
                <select class="form-select" name="sortGender" th:value="${sortGender}">
                    <option th:selected="${sortGender == null}" th:value=null th:text="성별" selected></option>
                    <option th:selected="${sortGender == 'MALE'}" th:value="MALE" th:text="남성"></option>
                    <option th:selected="${sortGender == 'FEMALE'}" th:value="FEMALE" th:text="여성"></option>
                </select>
            </form>
        </div>
        <div class="col-1">
            <form class="input-group">
                <select class="form-select" name="sortType" th:value="${sortType}">
                    <option th:selected="${sortType == null}" th:value=null th:text="타입" selected></option>
                    <option th:selected="${sortType == 'TOP'}" th:value="TOP" th:text="상의"></option>
                    <option th:selected="${sortType == 'BOTTOM'}" th:value="BOTTOM" th:text="하의"></option>
                    <option th:selected="${sortType == 'SHOES'}" th:value="SHOES" th:text="신발"></option>
                </select>
            </form>
        </div>
        <div class="col-1">
            <form class="input-group">
                <select class="form-select" name="sortSeason" th:value="${sortSeason}">
                    <option th:selected="${sortSeason == null}" th:value=null th:text="계절" selected></option>
                    <option th:selected="${sortSeason == 'SPRING'}" th:value="SPRING" th:text="봄"></option>
                    <option th:selected="${sortSeason == 'SUMMER'}" th:value="SUMMER" th:text="여름"></option>
                    <option th:selected="${sortSeason == 'AUTUMN'}" th:value="AUTUMN" th:text="가을"></option>
                    <option th:selected="${sortSeason == 'WINTER'}" th:value="WINTER" th:text="겨울"></option>
                </select>
            </form>
        </div>
    </div>
<h2>SHOPPING MALL</h2>
    <div id="merchandise-list" th:replace="fragments/merchandise-list :: merchandise-list"></div>
    <a th:href="@{merchandise/create}" class="btn btn-primary">상품 등록하기</a>
</div>
<script layout:fragment="script" type='text/javascript'>
function onClick(){
    event.preventDefault();
        $.ajax({
            type: "GET",
            url: "/home",
            dataType: "json",
            data: {
                "kw": $("#kw").val(),
                "sortList": $("select[name=sortList] option:selected").val(),
                "sortGender": $("select[name=sortGender] option:selected").val(),
                "sortType": $("select[name=sortType] option:selected").val(),
                "sortSeason": $("select[name=sortSeason] option:selected").val()
            },
            success: function(response){
                $('#merchandise-list').html(data.html);
            },
            error: function(xhr, status. error){
                console.error(error);
            }
        })
    }


function onClick2(){
    event.preventDefault();
        $.ajax({
            type: "GET",
            url: "/home",
            dataType: "json",
            data: {
                "kw": $("#kw").val(),
                "sortList": $("select[name=sortList] option:selected").val(),
                "sortGender": $("select[name=sortGender] option:selected").val(),
                "sortType": $("select[name=sortType] option:selected").val(),
                "sortSeason": $("select[name=sortSeason] option:selected").val()
            },
            success: function(response){
                $('#merchandise-list').html(data.html);
            },
            error: function(xhr, status. error){
                console.error(error);
            }
        })
    }

$("select[name=sortList]").change(function(){
    $.ajax({
        type: "GET",
        url: "/home",
        dataType: "json",
        data: {
            "kw": $("#kw").val(),
            "sortList": $("select[name=sortList] option:selected").val(),
            "sortGender": $("select[name=sortGender] option:selected").val(),
            "sortType": $("select[name=sortType] option:selected").val(),
            "sortSeason": $("select[name=sortSeason] option:selected").val()
        },
        success: function(response){
            $('#merchandise-list').html(data.html);
        },
        error: function(xhr, status. error){
            console.error(error);
        }
    })
});

$("select[name=sortGender]").change(function(){
    $.ajax({
        type: "GET",
        url: "/home",
        dataType: "json",
        data: {
            "kw": $("#kw").val(),
            "sortList": $("select[name=sortList] option:selected").val(),
            "sortGender": $("select[name=sortGender] option:selected").val(),
            "sortType": $("select[name=sortType] option:selected").val(),
            "sortSeason": $("select[name=sortSeason] option:selected").val()
        },
        success: function(response){
            $('#merchandise-list').html(data.html);
        },
        error: function(xhr, status. error){
            console.error(error);
        }
    })
});

$("select[name=sortType]").change(function(){
    $.ajax({
        type: "GET",
        url: "/home",
        dataType: "json",
        data: {
            "kw": $("#kw").val(),
            "sortList": $("select[name=sortList] option:selected").val(),
            "sortGender": $("select[name=sortGender] option:selected").val(),
            "sortType": $("select[name=sortType] option:selected").val(),
            "sortSeason": $("select[name=sortSeason] option:selected").val()
        },
        success: function(response){
            $('#merchandise-list').html(data.html);
        },
        error: function(xhr, status. error){
            console.error(error);
        }
    })
});

$("select[name=sortSeason]").change(function(){
    $.ajax({
        type: "GET",
        url: "/home",
        dataType: "json",
        data: {
            "kw": $("#kw").val(),
            "sortList": $("select[name=sortList] option:selected").val(),
            "sortGender": $("select[name=sortGender] option:selected").val(),
            "sortType": $("select[name=sortType] option:selected").val(),
            "sortSeason": $("select[name=sortSeason] option:selected").val()
        },
        success: function(response){
            $('#merchandise-list').html(data.html);
        },
        error: function(xhr, status. error){
            console.error(error);
        }
    })
});
</script>
</html>

